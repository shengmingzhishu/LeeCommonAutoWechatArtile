# 微信公众号文章排版与发布工具

## 项目概述
这是一个基于Web的微信公众号文章排版与发布工具，支持：
- SVG图形化排版界面
- 多种内容组件（文本、图片、标题、引用等）
- 模板管理功能
- Markdown格式优化
- 图书介绍排版
- 与微信公众号平台集成发布

## 功能特性

### 1. 排版功能
- **组件库**：标题、文本、图片、分割线、引用块、列表、高亮文本、图书组件等
- **格式化**：字体、字号、粗体、斜体、下划线、颜色、对齐等
- **模板系统**：支持保存、加载、导入、导出模板
- **历史记录**：支持撤销、重做操作

### 2. 特殊排版模式
- **图片排版**：支持图片+文字描述布局
- **图书介绍**：支持多本书籍介绍布局
- **MD优化**：支持Markdown格式优化

### 3. 发布功能
- 文章信息填写（标题、作者、摘要、封面图）
- 原创标记
- 与微信公众号平台集成发布

## 使用说明

### 1. 排版操作
1. 从左侧组件库拖拽组件到排版区域
2. 点击组件可进行编辑和格式化
3. 使用工具栏进行文字格式化
4. 可以复制、粘贴、删除组件

### 2. 模板管理
1. **保存模板**：点击"💾 保存为模板"按钮
2. **加载模板**：在"我的模板"区域点击"加载"按钮
3. **导入/导出**：使用相应按钮进行模板文件操作

### 3. 发布文章
1. 点击工具栏的"发布"按钮
2. 填写文章信息（标题、作者、摘要等）
3. 点击"确认发布"按钮
4. 文章数据将保存到localStorage，等待发布脚本处理

## 技术实现

### 前端（index.html）
- 使用SVG进行图形化排版
- 原生JavaScript实现所有功能
- 响应式布局设计
- 本地存储模板数据

### 后端发布脚本（wechat_publisher_updated.py）
- 使用Playwright进行浏览器自动化
- 与微信公众号平台交互
- 从localStorage读取文章数据
- 实现文章发布流程

## 集成发布流程

1. 在前端完成文章排版
2. 点击发布按钮并填写文章信息
3. 前端将文章数据保存到localStorage
4. 运行Python发布脚本
5. 脚本从localStorage读取数据并发布到微信公众号

## 运行方法

### 启动前端
```bash
# 启动本地服务器
python3 -m http.server 8080
# 然后在浏览器中访问 http://localhost:8080
```

### 运行发布脚本
```bash
# 安装依赖
pip install playwright
playwright install chromium

# 运行发布脚本
python3 wechat_publisher_updated.py
```

## 依赖项
- Python 3.x
- Playwright (浏览器自动化)
- Chromium浏览器

## 注意事项
1. 发布功能需要先在浏览器中登录微信公众号平台
2. 发布脚本需要在用户已登录的状态下运行
3. 确保网络连接稳定以保证发布成功

## 文件结构
- `index.html` - 前端排版界面
- `wechat_publisher_updated.py` - 更新后的发布脚本
- `wechat_publisher.py` - 原始发布脚本
- `update_function.py` - 更新函数的辅助脚本